<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Car Sales Prediction</title>
</head>
<body>
  <h1>Car Sales Prediction</h1>

  <div>
    <label for="lag1">Price Lag 1:</label>
    <input id="lag1" type="number" step="any" />
  </div>
  <div>
    <label for="lag2">Price Lag 2:</label>
    <input id="lag2" type="number" step="any" />
  </div>
  <div>
    <label for="lag3">Price Lag 3:</label>
    <input id="lag3" type="number" step="any" />
  </div>
  <div>
    <label for="lag4">Price Lag 4:</label>
    <input id="lag4" type="number" step="any" />
  </div>
  <div>
    <label for="lag5">Price Lag 5:</label>
    <input id="lag5" type="number" step="any" />
  </div>
  <div>
    <label for="lag6">Price Lag 6:</label>
    <input id="lag6" type="number" step="any" />
  </div>

  <button id="predict-btn">Get Prediction</button>

  <h2>Predicted Sales: <span id="prediction-output">N/A</span></h2>

  <script>
    document.getElementById("predict-btn").addEventListener("click", async () => {
      // Collect values
      const lag1 = document.getElementById("lag1").value;
      const lag2 = document.getElementById("lag2").value;
      const lag3 = document.getElementById("lag3").value;
      const lag4 = document.getElementById("lag4").value;
      const lag5 = document.getElementById("lag5").value;
      const lag6 = document.getElementById("lag6").value;

      // Build form data to match FastAPI's Form(...) inputs
      const formData = new FormData();
      formData.append("lag1", lag1);
      formData.append("lag2", lag2);
      formData.append("lag3", lag3);
      formData.append("lag4", lag4);
      formData.append("lag5", lag5);
      formData.append("lag6", lag6);

      try {
        const res = await fetch("/predict", {
          method: "POST",
          body: formData,
        });

        if (!res.ok) {
          const text = await res.text();
          document.getElementById("prediction-output").innerText =
            "Error: " + res.status + " " + text;
          return;
        }

        const data = await res.json();
        document.getElementById("prediction-output").innerText =
          data.prediction.toFixed(2);
      } catch (err) {
        document.getElementById("prediction-output").innerText =
          "Error: " + err;
      }
    });
  </script>
</body>
</html>
